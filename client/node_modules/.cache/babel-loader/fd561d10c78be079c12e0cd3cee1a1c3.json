{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createInterceptor = void 0;\n\nvar strict_event_emitter_1 = require(\"strict-event-emitter\");\n\nfunction createInterceptor(options) {\n  var observer = new strict_event_emitter_1.StrictEventEmitter();\n  var cleanupFns = [];\n  return {\n    apply: function () {\n      cleanupFns = options.modules.map(function (interceptor) {\n        return interceptor(observer, options.resolver);\n      });\n    },\n    on: function (event, listener) {\n      observer.addListener(event, listener);\n    },\n    restore: function () {\n      observer.removeAllListeners();\n\n      if (cleanupFns.length === 0) {\n        throw new Error(\"Failed to restore patched modules: no patches found. Did you forget to run \\\".apply()\\\"?\");\n      }\n\n      cleanupFns.forEach(function (restore) {\n        return restore();\n      });\n    }\n  };\n}\n\nexports.createInterceptor = createInterceptor;","map":{"version":3,"sources":["../src/createInterceptor.ts"],"names":[],"mappings":";;;;;;;AAEA,IAAA,sBAAA,GAAA,OAAA,CAAA,sBAAA,CAAA;;AAwEA,SAAgB,iBAAhB,CAAkC,OAAlC,EAA6D;AAC3D,MAAM,QAAQ,GAAG,IAAI,sBAAA,CAAA,kBAAJ,EAAjB;AACA,MAAI,UAAU,GAA2B,EAAzC;AAEA,SAAO;AACL,IAAA,KAAK,EAAA,YAAA;AACH,MAAA,UAAU,GAAG,OAAO,CAAC,OAAR,CAAgB,GAAhB,CAAoB,UAAC,WAAD,EAAY;AAC3C,eAAO,WAAW,CAAC,QAAD,EAAW,OAAO,CAAC,QAAnB,CAAlB;AACD,OAFY,CAAb;AAGD,KALI;AAML,IAAA,EAAE,EAAA,UAAC,KAAD,EAAQ,QAAR,EAAgB;AAChB,MAAA,QAAQ,CAAC,WAAT,CAAqB,KAArB,EAA4B,QAA5B;AACD,KARI;AASL,IAAA,OAAO,EAAA,YAAA;AACL,MAAA,QAAQ,CAAC,kBAAT;;AAEA,UAAI,UAAU,CAAC,MAAX,KAAsB,CAA1B,EAA6B;AAC3B,cAAM,IAAI,KAAJ,CACJ,0FADI,CAAN;AAGD;;AAED,MAAA,UAAU,CAAC,OAAX,CAAmB,UAAC,OAAD,EAAQ;AAAK,eAAA,OAAA,EAAA;AAAS,OAAzC;AACD;AAnBI,GAAP;AAqBD;;AAzBD,OAAA,CAAA,iBAAA,GAAA,iBAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createInterceptor = void 0;\nvar strict_event_emitter_1 = require(\"strict-event-emitter\");\nfunction createInterceptor(options) {\n    var observer = new strict_event_emitter_1.StrictEventEmitter();\n    var cleanupFns = [];\n    return {\n        apply: function () {\n            cleanupFns = options.modules.map(function (interceptor) {\n                return interceptor(observer, options.resolver);\n            });\n        },\n        on: function (event, listener) {\n            observer.addListener(event, listener);\n        },\n        restore: function () {\n            observer.removeAllListeners();\n            if (cleanupFns.length === 0) {\n                throw new Error(\"Failed to restore patched modules: no patches found. Did you forget to run \\\".apply()\\\"?\");\n            }\n            cleanupFns.forEach(function (restore) { return restore(); });\n        },\n    };\n}\nexports.createInterceptor = createInterceptor;\n//# sourceMappingURL=createInterceptor.js.map"]},"metadata":{},"sourceType":"script"}